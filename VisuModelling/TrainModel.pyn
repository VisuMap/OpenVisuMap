# TrainModel.pyn
#
vv.Import('ModellingHelp.pyn')
if vmd.NN is not None:
    del vmd.NN
    vmd.NN = None
mapDs = MapDataset()
inDim, outDim = mapDs.X.shape[1], mapDs.Y.shape[1]
#vmd.NN = NeuralNetwork([inDim, 128, 64, 10, outDim], mapDs)
vmd.NN = NeuralNetwork([inDim,  128, 64, 10,  outDim], mapDs)
vmd.NN.Train(mapDs, epochs=200, batch_size=25, lr=0.00025, gamma=0.8)
ShowPred(vmd.NN, mapDs.XX, mapDs.Y)
