# VsTrain.pyn
vv.Import('CommonUtil.pyn')
vv.Import('VsModelling.pyn')

InitVmd()
vmd.Clear()
X = np.concatenate( (GetMapData('Tst'), GetMapData('TstEuc')), axis=1 )
Y = GetMapData('2D')
vmd.ds = TrainDataset(X, Y)
dimList, DropR, LR  = [256, 128, 64, 32], 0.25, 0.0001

vmd.model = NewMapModel(dimList, X, Y, DropR)
vmd.EnableLog()
TrainModel(vmd, epochs = 5000, initial_lr=LR, logCallback=MapLogger)
#ShowPred(vmd.model(X, training=False).numpy(), Y)
