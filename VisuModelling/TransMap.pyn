# VsTrain.pyn
vv.Import('CommonUtil.pyn')
vv.Import('VsModelling.pyn')

InitVmd()
vmd.Clear()
vmd.ds = TrainDataset(GetMapData(), GetMapData('2D'))
dimList, DropR, LR  = [16, 32, 64, 32, 16], 0.25, 0.0001

vmd.model = NewMapModel(dimList, vmd.ds.X, vmd.ds.Y, DropR)
vmd.EnableLog()
TrainModel(vmd, epochs = 2000, initial_lr=LR, logCallback=MapLogger)
ShowPred(vmd.model(vmd.ds.X, training=False).numpy(), vmd.ds.Y)
