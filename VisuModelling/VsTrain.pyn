# VsTrain.pyn
vv.Import('VsModelling.pyn')

if vmd.model is not None:
    del vmd.model
    vmd.model = None
if vmd.ds is not None:
    del vmd.ds
    vmd.ds = None

vmd.ds = MapDataset(25)
inDim = vmd.ds.X.shape[1]
outDim = vmd.ds.Y.shape[1]
dimList = [inDim, inDim, inDim, 10, outDim]

vmd.model = NewMapModel(dimList, vmd.ds.Y)
vmd.EnableLog()
TrainModel(vmd.model, vmd.ds, epochs = 200, initial_lr=0.001)
ShowPred(vmd.model(vmd.ds.X).numpy(), vmd.ds.Y)

